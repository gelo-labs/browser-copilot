<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeloLabs Logo Spinner Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #1a1a1a;
            color: white;
        }
        
        .header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 40px;
            padding: 20px;
            background-color: #2a2a2a;
            border-radius: 8px;
        }
        
        .logo {
            width: 48px;
            height: 48px;
            background: linear-gradient(45deg, #00d4ff, #0099cc);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 18px;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        button {
            background: #0099cc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        button:hover {
            background: #007aa3;
        }
        
        button:disabled {
            background: #555;
            cursor: not-allowed;
        }
        
        .status {
            background: #2a2a2a;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        
        .logs {
            background: #000;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #333;
        }
        
        .log-entry {
            margin-bottom: 5px;
            opacity: 0.8;
        }
        
        .log-entry.error {
            color: #ff6b6b;
        }
        
        .log-entry.success {
            color: #51cf66;
        }
        
        .log-entry.info {
            color: #74c0fc;
        }
    </style>
</head>
<body>
    <div class="header">
        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDgiIHZpZXdCb3g9IjAgMCA0OCA0OCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMjQiIGN5PSIyNCIgcj0iMjQiIGZpbGw9InVybCgjZ3JhZGllbnQwX2xpbmVhcikiLz4KPHN0eWxlPgpAa2V5ZnJhbWVzIHNwaW4gewogIGZyb20geyB0cmFuc2Zvcm06IHJvdGF0ZSgwZGVnKTsgfQogIHRvIHsgdHJhbnNmb3JtOiByb3RhdGUoMzYwZGVnKTsgfQp9Cjwvc3R5bGU+CjxkZWZzPgo8bGluZWFyR3JhZGllbnQgaWQ9ImdyYWRpZW50MF9saW5lYXIiIHgxPSIwIiB5MT0iMCIgeDI9IjQ4IiB5Mj0iNDgiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agc3RvcC1jb2xvcj0iIzAwZDRmZiIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiMwMDk5Y2MiLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8dGV4dCB4PSIyNCIgeT0iMzAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IndoaXRlIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCI+RzwvdGV4dD4KPC9zdmc+" 
              class="logo" alt="GeloLabs Logo">
        <div>
            <h1>GeloLabs Logo Spinner Test</h1>
            <p>Test the realistic spinning animation with inertia effects</p>
        </div>
    </div>
    
    <div class="controls">
        <button id="startSpinning">Start Copilot (Spin Logo)</button>
        <button id="stopSpinning">Stop Copilot (Stop Spin)</button>
        <button id="testReduced">Test Reduced Motion</button>
        <button id="getStatus">Get Status</button>
        <button id="clearLogs">Clear Logs</button>
    </div>
    
    <div class="status">
        <h3>Extension Status</h3>
        <p><strong>Logo Found:</strong> <span id="logoStatus">Checking...</span></p>
        <p><strong>Spinning:</strong> <span id="spinStatus">No</span></p>
        <p><strong>Reduced Motion:</strong> <span id="motionStatus">Checking...</span></p>
        <p><strong>Extension Loaded:</strong> <span id="extensionStatus">Checking...</span></p>
    </div>
    
    <div class="logs">
        <h3>Console Logs</h3>
        <div id="logContainer"></div>
    </div>

    <script>
        // Test script to simulate extension functionality
        let isSpinning = false;
        let logoElement = null;
        let reducedMotionEnabled = false;
        
        // Check if extension is loaded
        function checkExtensionStatus() {
            if (typeof chrome !== 'undefined' && chrome.runtime && chrome.runtime.sendMessage) {
                document.getElementById('extensionStatus').textContent = 'Yes';
                log('Extension detected', 'success');
                return true;
            } else {
                document.getElementById('extensionStatus').textContent = 'No (Running in standalone mode)';
                log('Extension not detected - running in test mode', 'info');
                return false;
            }
        }
        
        // Logging function
        function log(message, type = 'info') {
            const logContainer = document.getElementById('logContainer');
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry ${type}`;
            logEntry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logContainer.appendChild(logEntry);
            logContainer.scrollTop = logContainer.scrollHeight;
            console.log(message);
        }
        
        // Find logo element
        function findLogo() {
            const selectors = [
                'img.logo[alt="GeloLabs Logo"]',
                'img[alt="GeloLabs Logo"]',
                '.logo[alt*="GeloLabs"]',
                'img[src*="logo"]'
            ];
            
            for (const selector of selectors) {
                const element = document.querySelector(selector);
                if (element) {
                    log(`Logo found with selector: ${selector}`, 'success');
                    return element;
                }
            }
            return null;
        }
        
        // Check reduced motion preference
        function checkReducedMotion() {
            if (window.matchMedia) {
                const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');
                reducedMotionEnabled = mediaQuery.matches;
                document.getElementById('motionStatus').textContent = reducedMotionEnabled ? 'Yes' : 'No';
                
                mediaQuery.addEventListener('change', (e) => {
                    reducedMotionEnabled = e.matches;
                    document.getElementById('motionStatus').textContent = reducedMotionEnabled ? 'Yes' : 'No';
                    log(`Reduced motion preference changed: ${reducedMotionEnabled}`, 'info');
                });
            }
        }
        
        // Update status display
        function updateStatus() {
            document.getElementById('logoStatus').textContent = logoElement ? 'Yes' : 'No';
            document.getElementById('spinStatus').textContent = isSpinning ? 'Yes' : 'No';
        }
        
        // Simulate extension message sending
        function sendExtensionMessage(action, data = {}) {
            if (typeof chrome !== 'undefined' && chrome.runtime && chrome.runtime.sendMessage) {
                chrome.runtime.sendMessage({ action, ...data }, (response) => {
                    log(`Message sent: ${action}, Response: ${JSON.stringify(response)}`, 'info');
                });
            } else {
                log(`Simulated message: ${action} with data: ${JSON.stringify(data)}`, 'info');
                
                // Simulate the content script behavior
                if (action === 'copilot:busy') {
                    simulateSpinning(true, data.reason);
                } else if (action === 'copilot:idle') {
                    simulateSpinning(false);
                }
            }
        }
        
        // Simulate spinning animation
        function simulateSpinning(shouldSpin, reason = 'test') {
            isSpinning = shouldSpin;
            
            if (!logoElement) {
                logoElement = findLogo();
            }
            
            if (logoElement) {
                if (shouldSpin) {
                    log(`Starting spin animation (${reason})`, 'success');
                    logoElement.classList.remove('gelolabs-copilot-progress');
                    
                    if (reducedMotionEnabled) {
                        logoElement.classList.add('gelolabs-copilot-progress');
                    } else {
                        logoElement.classList.add('gelolabs-copilot-spinning');
                    }
                } else {
                    log('Stopping spin animation', 'success');
                    logoElement.classList.remove('gelolabs-copilot-spinning', 'gelolabs-copilot-progress');
                }
            } else {
                log('Logo element not found!', 'error');
            }
            
            updateStatus();
        }
        
        // Event listeners
        document.getElementById('startSpinning').addEventListener('click', () => {
            sendExtensionMessage('copilot:busy', { reason: 'user-test' });
        });
        
        document.getElementById('stopSpinning').addEventListener('click', () => {
            sendExtensionMessage('copilot:idle');
        });
        
        document.getElementById('testReduced').addEventListener('click', () => {
            // Toggle reduced motion for testing
            reducedMotionEnabled = !reducedMotionEnabled;
            document.getElementById('motionStatus').textContent = reducedMotionEnabled ? 'Yes' : 'No';
            log(`Toggled reduced motion: ${reducedMotionEnabled}`, 'info');
            
            // If currently spinning, restart with new preference
            if (isSpinning) {
                simulateSpinning(false);
                setTimeout(() => simulateSpinning(true, 'reduced-motion-test'), 100);
            }
        });
        
        document.getElementById('getStatus').addEventListener('click', () => {
            if (typeof chrome !== 'undefined' && chrome.runtime) {
                chrome.runtime.sendMessage({ action: 'gelolabs:getStatus' }, (response) => {
                    log(`Status: ${JSON.stringify(response)}`, 'info');
                });
            } else {
                const status = {
                    spinning: isSpinning,
                    logoFound: !!logoElement,
                    reducedMotion: reducedMotionEnabled
                };
                log(`Status: ${JSON.stringify(status)}`, 'info');
            }
        });
        
        document.getElementById('clearLogs').addEventListener('click', () => {
            document.getElementById('logContainer').innerHTML = '';
        });
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            log('Test page loaded', 'info');
            checkExtensionStatus();
            logoElement = findLogo();
            checkReducedMotion();
            updateStatus();
            
            // Auto-start spinning for demo
            setTimeout(() => {
                log('Auto-starting spinner demo', 'info');
                simulateSpinning(true, 'auto-demo');
            }, 1000);
        });
    </script>
</body>
</html>
